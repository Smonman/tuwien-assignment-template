%%% TUWIEN ASSIGNMENT TEMPLATE
% Author: Simon Josef Kreuzpointner
% Date: 31.05.2023
% Version: 0.3.0

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{tuwienassignment}[2023/05/31 inofficial TU Vienna assigment template]

% PACKAGES
\RequirePackage[a4paper,top=3cm,bottom=2cm,left=2cm,right=2cm,headsep=1cm]{geometry} % layout
\RequirePackage[utf8]{inputenc} % input encoding
\RequirePackage[T1]{fontenc} % font encoding for umlaute
\RequirePackage[naustrian,english]{babel} % language
\RequirePackage{csquotes} % enqote
\RequirePackage{iflang} % conditional statements based on selected language
\RequirePackage{ifthen} % for conditinal branching
\RequirePackage[skip=4pt, indent=10pt]{parskip} % spacing between paragraphs
\RequirePackage{titling} % title
\RequirePackage{fancyhdr} % header and footer
\RequirePackage{amsmath} % math
\RequirePackage{amssymb} % math symbols
\RequirePackage{mathtools} % enhances amsmath
\RequirePackage{amsthm} % 
\RequirePackage{microtype} % improves the spacing between words and letters
\RequirePackage[inline]{enumitem} % horizontal lists
\RequirePackage{graphicx} % graphics, images
\RequirePackage{array} % extension of array and tabular environments
\RequirePackage{xcolor} % work with colors
\RequirePackage{fp} % fixed point arithmetic
\RequirePackage{booktabs} % better table design
\RequirePackage{tabularx} % better table layout
\RequirePackage{xltabular} % tabularx tables over multiple pages
\RequirePackage{nicematrix} % better matrices
\RequirePackage{makecell} % table cell configuration
\RequirePackage{listings} % code listing
\RequirePackage{pgfkeys} % pgf keys
\RequirePackage{tikz} % draw diagrams and figures
\RequirePackage{varwidth} % variable width mini-page
\RequirePackage{float} % 
% MUST BE PLACED LAST
\RequirePackage[colorlinks=true, allcolors=blue]{hyperref}

%%% COLORS
% standard colors
\definecolor{myyellow}{rgb}{0.94, 0.82, 0.007}
\definecolor{myred}{rgb}{0.75, 0.16, 0.18}
\definecolor{myblue}{rgb}{0.13, 0.34, 0.53}
\definecolor{mydarkblue}{rgb}{0.1, 0.16, 0.27}
\definecolor{mylightblue}{rgb}{0.39, 0.68, 1}
\definecolor{mydarkgreen}{rgb}{0, 0.4, 0}
\definecolor{mysmoke}{rgb}{0.9, 0.9, 0.9}
% lstlisting
\definecolor{codegray}{HTML}{707070}
\definecolor{codelightgray}{HTML}{FAFAFA}
\definecolor{codegreen}{HTML}{24751B}
\definecolor{codeblue}{HTML}{1733BF}

%%% GRAPHIXS PATH
\graphicspath{{./img/}}

%%% TITLE STYLE
\newcommand{\authormatrikelnrspacing}{\ifthenelse{\equal{\@author}{}}{}{\quad}}
% before title
\pretitle{%
  \begin{raggedright}%
    \Huge%
    }%
    % after title
    \posttitle{%
    \newline%
  \end{raggedright}%
  \noindent\vrule height 2.5pt width \textwidth%
  \vskip .75em plus .25em minus .25em%
}%
% before author
\preauthor{
  \begin{raggedright}
    \itshape%
    }%
    % after author
    \postauthor{%
  \end{raggedright}%
  \noindent\authormatrikelnrspacing\@matrikelnr%
  \newline%
}%
% before date
\predate{
  \begin{raggedright}
    }
    % after date
    \postdate{
  \end{raggedright}
}

%%% PAGESTYLE
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{\nouppercase{\leftmark}}
\fancyhead[R]{\@author \ \@matrikelnr}
\renewcommand{\headrulewidth}{0.2pt}
\fancyfoot[C]{\thepage}
\renewcommand{\footrulewidth}{0.2pt}
\renewcommand{\footruleskip}{1em}
\renewcommand{\subsectionmark}[1]{\markright{\thesubsection\ #1}}

\makeatletter
\DeclareRobustCommand\matrikelnr[1]{\gdef\@matrikelnr{#1}}
\makeatother

%%% ITEMIZE STYLE
\renewcommand\labelitemi{$\vcenter{\hbox{\small$\bullet$}}$}

%%% LSTLISTING STYLE
\lstdefinestyle{lststandardstyle}{
  backgroundcolor=\color{codelightgray},
  basicstyle=\ttfamily,
  breakatwhitespace=false,
  breaklines=true,
  captionpos=t,
  commentstyle=\color{codegray},
  deletekeywords={},
  extendedchars=true,
  firstnumber=1,
  frame=single,
  keepspaces=true,
  keywordstyle=\color{codeblue}\bfseries,
  morekeywords={*,...},
  numbers=left,
  numbersep=5pt,
  numberstyle=\sffamily\small\color{codegray},
  rulecolor=\color{black},
  showspaces=false,
  showstringspaces=false,
  showtabs=false,
  stepnumber=1,
  stringstyle=\color{codegreen},
  tabsize=4,
  escapeinside={(*}{*)},
  linewidth=\columnwidth,
  xleftmargin=3.4pt,
  xrightmargin=3.4pt,
  postbreak=\mbox{\textcolor{gray}{\(\hookrightarrow\)}\space},
}
\lstdefinestyle{lstoutput}{
  backgroundcolor=\color{codelightgray},
  basicstyle=\ttfamily,
  breakatwhitespace=false,
  breaklines=true,
  captionpos=t,
  extendedchars=true,
  firstnumber=1,
  frame=single,
  keepspaces=true,
  rulecolor=\color{black},
  stepnumber=0,
  tabsize=4,
  title=Output,
  escapeinside={(*}{*)},
}
\lstdefinelanguage{pseudo}{
  mathescape=true,
  basicstyle=,
  keywordstyle=\color{black}\bfseries\em,
  morekeywords={function, returns, return, if, then, else, and, or, not, loop, do, while, for, each, switch, case, foreach, begin, end, endif, until, repeat, null},
  sensitive=false,
  morecomment=[l]{//},
  morecomment=[s]{/*}{*/},
  morestring=[b]"
}
\lstset{
  style=lststandardstyle,
  framerule=0.8pt,
  rulesep=0pt,
  inputpath={{./scripts/}}
}

\newcommand{\lstinputpath}[1]{\lstset{inputpath=#1}}

%%% TIKZ
% tikz libraries
\usetikzlibrary{
  shapes.geometric,
  arrows,
  positioning,
  bending,
  fit
}

% default node distance
\tikzset{node distance=1cm}

\tikzstyle{arrow} = [
very thick,
->,
-stealth,
rounded corners=3mm,
shorten <=2pt,
shorten >=2pt
]

%%% PGF LAYERS
% declare a new background layer beneath the main layer
\pgfdeclarelayer{background}
\pgfsetlayers{background,main}

%%% TABULARX
% declare a new column type, that auto sizes but has ragged right text
\newcolumntype{Z}{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}X}
% declare a new column type, that auto sizes and centeres the text
\newcolumntype{Y}{>{\centering\arraybackslash}X}

%%% TABLE HEADER
% set table header to bold
\renewcommand\theadfont{\bfseries}
\renewcommand{\theadalign}{cl}
\renewcommand{\cellalign}{tl}

%%% TABLE ROWS
% table row spacing
\renewcommand{\arraystretch}{1.5}

%%% NEW COMMANDS
% math set
\makeatletter
\DeclareRobustCommand{\mset}{\@ifstar{\@@mset}{\@mset}}
\newcommand{\@mset}[1]{\ensuremath{\left\{ \ifthenelse{\equal{#1}{}}{}{\, #1 \,} \right\}}}
\newcommand{\@@mset}[1]{\ensuremath{\left\{ \, \ifthenelse{\equal{#1}{}}{\emptyset}{#1} \, \right\}}}
\makeatother
\newcommand{\msetmid}[2]{\ensuremath{\mset{ #1 \msetmidsa #2 }}}
\newcommand{\msetmidsa}{\ensuremath{\, \middle| \,}}
% math tuple
\newcommand{\mtupel}[1]{\ensuremath{\left\langle \ifthenelse{\equal{#1}{}}{}{\, #1 \,} \right\rangle}}
% logical true and false
\newcommand{\ltrue}{\top}
\newcommand{\lfalse}{\bot}
% abs and norm
\DeclarePairedDelimiter\abs{\lvert}{\rvert}%
\DeclarePairedDelimiter\norm{\lVert}{\rVert}%
\makeatletter
\let\oldabs\abs
\def\abs{\@ifstar{\oldabs}{\oldabs*}}
\let\oldnorm\norm
\def\norm{\@ifstar{\oldnorm}{\oldnorm*}}
\makeatother

%%% CONDITIONS
\newenvironment{conditions}[1][\dots]{%
\renewcommand{\arraystretch}{1.25}\par\noindent%
\setlength\tabcolsep{1.5pt}%
\newcommand{\sep}{#1}%
\tabularx{\linewidth}{>{\(}r<{\)}>{\(}c<{\)}l}%
}{%
\endtabularx\par\vspace{\belowdisplayskip}
}

%%% EXERCISE AND SOLUTRION
% counters
\newcounter{exercisecounter}
\newcounter{solutioncounter}
% exercise
\pgfkeys{
  /exercise/.is family, /exercise,
  title/.estore in=\exercisetitle,
  solution/title/.estore in=\solutiontitle,
  default/.style={title={Exercise},solution/title={Solution}}
}
\newenvironment{exercise}[1][]{
  \pgfkeys{/exercise, default, #1}
  \bigskip%
  \noindent%
  \setcounter{solutioncounter}{1}%
  \refstepcounter{exercisecounter}%
  \textbf{\large \exercisetitle \ \theexercisecounter}%
  \newline%
}{
  \par%
  \bigskip%
}
\numberwithin{exercisecounter}{section}
% solution
\newenvironment{solution}[1][]{
  \pgfkeys{/exercise, default, #1}
  \par%
  \medskip%
  \noindent%
  \textbf{\solutiontitle \ \thesolutioncounter}%
  \newline%
}{
  \refstepcounter{solutioncounter}%
  \par%
  \medskip%
}
